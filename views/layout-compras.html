{# Heredando la plantilla principal #}


{% extends 'default_layout.html' %}

{% block extraCSS %}

{% endblock %}

{% block javascripts %}
		<!-- JS para esta página. -->
		<script type="text/javascript" src="js_libs/jquery-mask/jquery.inputmask.bundle.js"></script>
		<!-- JS BUSQUEDA DE PROVEEDORES Y PRODUCTOS. -->
		<script type="text/JavaScript" src="js_libs/DatosBuscarProveedores.js"></script> <!-- Administrar la Factura Ventas y Detalles Ventas -->
		<script type="text/JavaScript" src="js_libs/DatosBuscarProductosCompras.js"></script> <!-- buscar datos en la tabla productos  y austed el PRECIO DE COMPRA-->
		<!-- JS COMPRA. -->
		<script type="text/JavaScript" src="js_libs/cargar-datos-compras.js"></script> <!-- Rellena los SELECT necesarios en compras -->
		<script type="text/JavaScript" src="js_libs/DatosCompras.js"></script> <!-- serviara para guardar la información de la compra -->
		<!-- JS CATALOGO PROVEEDORES. -->
		<script type="text/JavaScript" src="js_libs/CatalogoProveedores.js"></script> <!-- Administrar la tabla catalogo proveedores -->
		<script type="text/JavaScript" src="js_libs/cargar-datos-proveedores.js"></script> <!-- Administrar la Factura Ventas y Detalles Ventas -->
		<!-- JS CATALOGO productos. -->
		<script type="text/javascript" src="js_libs/formato-moneda.js"></script>
		<script type="text/JavaScript" src="js_libs/CatalogoProductos.js"></script> <!-- Administrar la tabla pesonal -->
		<script type="text/javascript" src="js_libs/default.js"></script>
		<script type="text/JavaScript" src="js_libs/cargar-datos-productos.js"></script> <!-- Administrar la tabla pesonal -->
		
		<script language="javascript">
			// VALIDAR LOS ENTER EN EL FORMULARIO.
			$(document).ready(function() {
				$('form').keypress(function(e){   
				  if(e == 13){
					return false;
				  }
				});
		  
				$('input').keypress(function(e){
				  if(e.which == 13){
					return false;
				  }
				});
				
				$("#txtNumeroFactura").inputmask("integer",{
					autoGroup: true
				});
				
			});
		</script>
{% endblock %}

{% block contenidos %}
<div class="container-fluid">
	<div class="row mt-1 text-dark">
			<div class="col">
				<ul class="nav nav-tabs">
					<li class="nav-item">
						<a href="#tab1" class="nav-link active" data-toggle="tab"><span class="fa fa-industry"></span> Compras</a>
					</li>
				</ul>

				<div class="tab-content">
					<div class="tab-pane active" id="tab1" role="tabpanel">
						<div class="row">
								<div class="col col-md-12 col-lg-12 col-xl-12">
									<form method="" name="formFacturaCompras" id="formFacturaCompras" role="form">
										<!-- INPUT OCULTOS -->
											<input type="hidden" id="accion_factura" name="accion_factura" value = "GuardarFacturaCompras" class="{required:true}">
											<input type="hidden" id="txtCodigoProveedorCompras" name="txtCodigoProveedorCompras" value = "">
											<input type="hidden" id="estado_factura" name="estado_factura" value = "01">
											<input type="hidden" id="txtTotalCompra" name="txtTotalCompra" value = "0" required>
											<input type="hidden" id="lstLineaFactura" name="lstLineaFactura" value = "50">
										<div class="form-group row">
											<!-- BOTON DESPLEGABLES PROVEEDORES-->
											<div class="col-12 col-md-12 col-lg-2 col-xl-2 border border-primary">
												<div class="btn-group btn-group-sm" role="group">
													<button type="button" id="BotonBuscarProveedor" class="btn btn-success">Proveedores</button>
													<button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
													  <span class="sr-only">Toggle Dropdown</span>
													</button>
													<div class="dropdown-menu">
													  <a class="dropdown-item" href="#" id="goBuscarProveedor"><span class="fa fa-search"></span> Buscar</a>
													  <a class="dropdown-item" href="#" id="NuevoEmpresaPersona"><span class="fa fa-file"></span> Nuevo</a>
													</div>
												 </div>
											</div>
											<div class="col-12 col-md-12 col-lg-3 col-xl-3 border border-primary rounded">
												<h6><span for="txtNombreProveedor">Nombre Proveedor </span><label class="badge badge-secondary" for="lblCodigoProveedor"> Código</label></h6>
											</div>
											<!-- BOTON DESPLEGABLES PRODUCTOS -->
											<div class="col-12 col-md-12 col-lg-2 col-xl-4 border border-primary d-flex justify-content-between">
												<button type="button" class="btn btn-warning btn-md" id="goEliminarDetalleFactura" disabled><span class="fa fa-trash"></span> Borrar Detalle Factura</button>
												
												<div class="btn-group btn-group-sm" role="group">													
													<button type="button" id="BotonBuscarProducto" class="btn btn-success" disabled="disabled">Productos</button>
													<button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="GrupoBuscarProducto" disabled="disabled">
													  <span class="sr-only">Toggle Dropdown</span>
													</button>
													<div class="dropdown-menu">														
													  <a class="dropdown-item" href="#" id="goBuscarProducto"><span class="fa fa-search"></span> Buscar</a>
													  <a class="dropdown-item" href="#" id="NuevoProducto"><span class="fa fa-file"></span> Nuevo</a>
													</div>
												 </div>
											</div>
										<div class="col-12 col-md-12 col-lg-3 col-xl-3 border border-primary rounded d-flex justify-content-end">
												<button type="submit" class="btn btn-primary btn-md" id="goGuardarDetalleFactura" disabled><span class="fa" style="font-size: 24px;">&#xf0c7;</span> Guardar</button>
											</div>
										</div>
										<!-- FORM GRUUP INF. DE LA FACTURA, TABLA DE DETALLE DE PRODUCTOS Y SUMAS -->
												<div class="form-group form-group-sm row">
													<div class="col-12 col-md-12 col-lg-3 col-xl-2 border border-primary bg-secondary rounded info-factura" style="height: 300px;">
														<div class="p-1 mb-1 bg-secondary text-white text-center"><h4>FACTURA</h4></div>
														<div class="input-group input-group-sm mb-1">
															<div class="input-group-prepend">
																<span class="input-group-text">N° Factura</span>
															</div>
															<input type="text" name="txtNumeroFactura" id="txtNumeroFactura" class="form-control form-control-sm text-right font-weight-bold text-danger" required maxlength="12" style="font-size: 18px;">
														</div>
														
														<div class="input-group input-group-sm">
															<div class="input-group-prepend">
																<span class="input-group-text">Fecha</span>
															</div>
															<input type="date" name="txtFechaCompra" id="txtFechaCompra" class="form-control form-control-sm">
														</div>

														<div class="input-group input-group-sm">
															<div class="input-group-prepend">
																<span class="input-group-text">Tipo Factura</span>
															</div>
															<select name="lstTipoFactura" id="lstTipoFactura" class="form-control form-control-sm"></select>																					
														</div>

														<div class="input-group input-group-sm mb-1">
															<div class="input-group-prepend">
																<span class="input-group-text">Forma de Pago</span>
															</div>
															<select name="lstFormaPago" id="lstFormaPago" value="01" class="form-control form-control-sm"></select>																					
														</div>

														<div class="input-group input-group-sm">
															<div class="input-group-prepend">
																<span class="input-group-text">Vendedor</span>
															</div>
															<select name="lstCodigoVendedor" id="lstCodigoVendedor" class="form-control form-control-sm"></select>																					
														</div>
														
													</div>
													<div class="col-12 col-md-12 col-lg-6 col-xl-7 border border-dark rounded" style="height: 300px; overflow-y: scroll;">
														<table class="table table-responsive table-striped table-sm" id="DetalleFacturaTemp">
															<thead class="thead-inverse bg-dark text-white table-condensed table-striped">
																<tr>
																	<th>N°</th>
																	<th>Id</th>
																	<th>Código</th>
																	<th>Descripción</th>
																	<th>Cantidad</th>
																	<th>Precio Unitario $</th>
																	<th>Exentas $</th>
																	<th>Gravadas $</th>
																	<th></th>
																	<th></th>
																</tr>
															</thead>
																<tbody id="listaProductosTemp">
																</tbody>
															</table>
													</div>
													<div class="col-12 col-md-12 col-lg-3 col-xl-3 border border-primary bg-default rounded" style="height: 300px;">
														<div class="p-1 mb-1 bg-secondary text-white text-center"><h4>SUMAS</h4></div>
														<table class="table table-striped table-sm" id="TablaSumas">
															<thead>
																<tr>
																	<th></th>
																	<th style="text-align: center;">Exentas</th>
																	<th style="text-align: center;">Gravadas</th>
																</tr>
															</thead>
															<tbody>
																<tr>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0">
																		Sumas
																	</td>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0" style="text-align: right; font-size: 16px; color: green;"><b>$ <label for="SumasVentasExentas"></b></label></td>
																	<td style="text-align: right; font-size: 16px; color: brown;"><b>$ <label for="SumasVentasGravadas"></b></label></td>
																</tr>
																<tr>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0">
																		Sub-total
																	</td>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0"></td>
																	<td style="text-align: right; font-size: 16px; color: brown;"><b>$ <label for="SubTotal"></label></b></td>
																</tr>
																<tr>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0">
																		(+) IVA
																	</td>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0"></td>
																	<td style="text-align: right; font-size: 16px; color: red;"><b>$ <label for="IVA"></label></b></td>
																</tr>
																<tr>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0">
																		Exentas
																	</td>
																	<td class="border border-dark border-top-0 border-bottom-0 border-left-0"></td>
																	<td style="text-align: right; font-size: 16px; color: green;"><b>$ <label for="SumasVentasExentas"></label></b></td>
																</tr>
																<tr  class="border border-dark border-left-0 border-right-0">
																	<td>
																		TOTAL
																	</td>
																	<td></td>
																	<td style="text-align: right; font-size: 18px; color: blue;">$ <b><label for="Total"></b></label></td>
																</tr>																
															</tbody>
														</table>
													</div> <!-- SUMAS -->
												</div> <!-- FORM GROUP PARA INFORMACION DE LA FACTURA, TABLA Y SUMAS-->
									</form>					
								</div> <!-- col -->
						</div> <!-- row -->
					</div> <!-- tab 1 -->
				</div> <!-- tab content -->
			</div> <!-- col -->
		</div> <!-- row -->
</div> <!-- container -->
<div class="row mt-3 text-dark">
			<div class="col">
			<div class="modal fade" data-backdrop="static" data-keyboard="false" id="VentanaModificarAjusteCompra" tabindex="-2" role="dialog" aria-labelledby="VentanaModificarAjusteCompra" aria-hidden="true">
					<div class="modal-dialog modal-sm">
						<div class="modal-content">
							<div class="modal-header modal-header-info">
								<h6 class="modal-title" id=""><span class="fa fa-edit"></span>¿Editar Cantidad o Precio Costo?</h6>
								<button class="close" data-dismiss="modal" aria-label="Cerrar">
									<span aria-hidden="true">&times;</span>
								</button>
							</div>

							<div class="modal-body">
								<div class="container-fluid">
									<div class="row">
										<div class="col-12">
												<form  action="" method="post" name="formAjusteCompra" id="form" role="form">
													<div class="form-group row">
														<div class="input-group mb-2">
															<div class="input-group-prepend">
																<span class="input-group-text">Cantidad</span>
															</div>
															<input type="number" name="txtCantidadCompraAjusteModificar" id="txtCantidadCompraAjusteModificar" class="form-control">
														</div>
														<div class="input-group mb-2">
															<div class="input-group-prepend">
																<span class="input-group-text">Precio Costo</span>
															</div>
															<input type="text" name="txtPrecioCompraAjusteModificar" id="txtPrecioCompraAjusteModificar" class="form-control">
														</div>
													</div>
												</form>
										</div>
									</div>
								</div>
							</div>

							<div class="modal-footer">
								<button class="btn btn-success" id="goActualizarAjusteCompra" value="SiActualizarRegistro">Aceptar</button>
								<button class="btn btn-default" data-dismiss="modal">Cerrar</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div> 
<!-- plantilla que contiene el VentanaClientesEmpresa. -->
		{% include 'VentanaBuscarProveedor.html' %}
<!-- plantilla que contiene el VentanaClientesEmpresa. -->
		{% include 'VentanaBuscarProducto.html' %}
<!-- plantilla que contiene el VentanaClientesEmpresa. -->
		{% include 'VentanaEmpresaPersona.html' %}
<!-- plantilla que contiene el VentanaClientesEmpresa. -->
		{% include 'VentanaProductos.html' %}
<!-- plantilla que contiene el menú principal. -->
		{% include 'layout-loading.html' %}
<!--		VENTANA MODAL - MODIFICAR AJUSTE -->  		
{% endblock %}

{% block menu %}
<!-- plantilla que contiene el menú principal. -->
		{% include 'layout-menu.html' %}
{% endblock %}
 
{% block loginUser %}
	<!--	{% include 'layout-login-user.html' %} -->
{% endblock %}
